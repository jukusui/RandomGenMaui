<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:Jukusui.RandomGen.View.Control"
             xmlns:vm="clr-namespace:Jukusui.RandomGen.ViewModel"
             x:Class="Jukusui.RandomGen.View.DicePage"
             Title="DicePage">
    <ContentPage.BindingContext>
        <vm:DiceViewModel/>
    </ContentPage.BindingContext>
    <Grid VerticalOptions="Fill" Margin="16" RowSpacing="8">
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <FlexLayout Padding="-8,-8,-8,0" Wrap="Wrap" >
            <FlexLayout.Resources>
                <Style TargetType="Button">
                    <Setter Property="Margin" Value="4,4"/>
                </Style>
            </FlexLayout.Resources>
            <Button Text="2" Command="{Binding SetValueCommand}" CommandParameter="2"/>
            <Button Text="6" Command="{Binding SetValueCommand}" CommandParameter="6"/>
            <Button Text="10" Command="{Binding SetValueCommand}" CommandParameter="10"/>
            <Button Text="20" Command="{Binding SetValueCommand}" CommandParameter="20"/>
            <Button Text="100" Command="{Binding SetValueCommand}" CommandParameter="100"/>
        </FlexLayout>
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition Width="16"/>
                <ColumnDefinition Width="auto"/>
            </Grid.ColumnDefinitions>
            <Entry Grid.Row="1" Keyboard="Numeric" Text="{Binding MaximumText,Mode=TwoWay}" ClearButtonVisibility="WhileEditing"></Entry>
            <Stepper Grid.Row="1" Grid.Column="2" Value="{Binding Maximum,Mode=TwoWay}"
                     Minimum="{Binding RangeMin,Mode=OneTime}" Maximum="{Binding RangeMax,Mode=OneTime}"></Stepper>
        </Grid>
        <Label Grid.Row="2" Text="{Binding ErrorText,Mode=OneWay}"/>
        <Label Grid.Row="2" Text="1「DP」2" FontFamily="RandomGenIcon"/>
        <Button Grid.Row="3" Text="Roll" Command="{Binding RollCommand}"/>
        <Border Grid.Row="4">
            <CollectionView ItemsSource="{Binding Results}" SelectionMode="None"
                            ItemsUpdatingScrollMode="KeepLastItemInView" VerticalScrollBarVisibility="Always">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <HorizontalStackLayout>
                            <Label Text="{Binding Key}" WidthRequest="50"/>
                            <Label Grid.Column="1" Text="{Binding Value}"/>
                        </HorizontalStackLayout>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
        </Border>
    </Grid>
</ContentPage>